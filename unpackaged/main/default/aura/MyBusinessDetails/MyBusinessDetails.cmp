<aura:component
                implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction"
                access="global" controller='ET_BusinessCommunityController'>
    
    <!-- Handling events -->
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:handler event="c:MyBusinessEvent" action="{!c.handleApplicationEvent}" />
    <lightning:overlayLibrary aura:id="overlayLib"/>
    <!-- Registering events -->
    <aura:registerEvent name="appEvent" type="c:MyBusinessDetailPageEvent"/>
    
    <!-- Attributes to handle Business Menu Click-->
    <aura:attribute name="salesAgreementDashboard" type="Boolean" default="true" />
    <aura:attribute name="salesAgreement" type="Boolean" />
    <aura:attribute name="assignResources" type="Boolean" />
    <aura:attribute name="assignVehicles" type="Boolean" />
    <aura:attribute name="invoices" type="Boolean" />
    <aura:attribute name="schools" type="Boolean" />
    <aura:attribute name="students" type="Boolean" />
    <aura:attribute name="govtSchool" type="Boolean" />
    
    <aura:attribute name="studentsList" type="List" />
    
    <!-- Attributes to calculate Dashboard Values-->
    <aura:attribute name="activeSalesAgreements" type="Integer" default="0" />
    <aura:attribute name="activeVehicles" type="Integer" default="0" />
    <aura:attribute name="activeResources" type="Integer" default="0" />
    <aura:attribute name="activeInvoices" type="Integer" default="0" />
    <!-- aditional school business attributes-->
    <aura:attribute name="activeSchools" type="Integer" default="0" />
    <aura:attribute name="activeStudents" type="Integer" default="0" />
    
    <!-- Attributes to handle My Business Dashboard click-->
    <aura:attribute name="salesAgreementClick" type="Boolean" />
    <aura:attribute name="assignResourcesClick" type="Boolean" />
    <aura:attribute name="assignVehiclesClick" type="Boolean" />
    <aura:attribute name="invoicesClick" type="Boolean" />
    <!-- aditional school business attributes-->
    <aura:attribute name="schoolsClick" type="Boolean"/>
    <aura:attribute name="studentsClick" type="Boolean"/>
    
    
    <aura:attribute name="businessWrapper" type="ET_BusinessCommunityController.MyBusinessWrapper" />
    <aura:attribute name="today" type="Date" />
    
    <!-- Attributes to show detail page modal popup -->
    <aura:attribute name="showRecordDetailModal" type="Boolean" default="false"/>
    <aura:attribute name="recordDetailId" type="String" />
    <aura:attribute name="recordTypeName" type="String" />
    
    <!-- <div align="right">
        <lightning:button class="emmergencyButton" label="Emmergency" title="Emmergency" />
    </div> -->
    <div class="casesupmaindiv">
        <div class="menumaindiv"><div class="menudiv">
            <c:MenuItemsList />
            </div>
        </div>
        
        <!--aura:if isTrue="{!v.salesAgreementDashboard}"-->
            <!--
       <force:recordView recordId="a1W3L0000000TQz" type ="FULL"/>
        <lightning:recordForm
        recordId="a1W3L0000000TQz"
        objectApiName="ET_Sales_Agreement__c"
        layoutType="Full"
        mode="view" /> -->
            <div class="mybussinessdiv">
                <article class="slds-card">
                  
                        <a href="" onclick="{!c.handleSalesAgreementClickDashboard}">
                            <div class="slds-col">
                                <div class="form-box-row2" id="step-1">
                                    <div class="leftsectiondiv agreementbgimg">
                                    </div>
                                    <div class="rightsectiondiv">
                                        <div class="numberSize">
                                            {!v.activeSalesAgreements}
                                        </div>
                                        <h3 class="form-title">Active<br></br> Agreements</h3>
                                    </div>
                                </div>
                            </div>
                        </a>
                     <a href="" onclick="{!c.handleActiveResourceClickDashboard}">
                        <div class="slds-col">
                            <div class="form-box-row2" id="step-1">
                                <div class="leftsectiondiv resourcesbgimg">
                                    <!--<img src="{!$Resource.banner1}"/>-->
                                </div>
                                <div class="rightsectiondiv">
                                    <div class="numberSize">
                                        {!v.activeResources}
                                    </div>
                                    <h3 class="form-title">Active<br></br>  Resources</h3>
                                </div>
                            </div>
                        </div>
                    </a>
                    <a href="" onclick="{!c.handleActiveVehiclesClickDashboard}">
                        <div class="slds-col">
                            <div class="form-box-row2" id="step-1">
                                <div class="leftsectiondiv activevehiclebgimg">
                                    <!--<img src="{!$Resource.banner1}"/>-->
                                </div>
                                <div class="rightsectiondiv">
                                    <div class="numberSize">
                                        {!v.activeVehicles}
                                    </div>
                                    <h3 class="form-title">Active<br></br>  Vehicles</h3>
                                </div>
                            </div>
                        </div>
                    </a>
                    <aura:if isTrue="{!v.activeStudents==0}">
                        <a href="" onclick="{!c.handleActiveInvoicesClickDashboard}">
                            <div class="slds-col">
                                <div class="form-box-row2" id="step-1">
                                    <div class="leftsectiondiv invoicebgimg">
                                        <!--<img src="{!$Resource.banner1}"/>-->
                                    </div>
                                    <div class="rightsectiondiv">
                                        <div class="numberSize">
                                            {!v.activeInvoices}
                                        </div>
                                        <h3 class="form-title">Active <br></br>Invoices</h3> 
                                    </div>
                                </div>
                            </div>
                        </a>
                    </aura:if>
                </article>
            </div>
        <!--/aura:if-->
        
        <aura:if isTrue="{!v.salesAgreement}">
            
            <div class="slds-grid slds-gutters ">
                        <div class="slds-col maincantentdiv" style="padding-top:0px">
                             <aura:if isTrue="{!v.salesAgreementClick}">
                            <h3 class="Headingcontent">Active Sales Agreements</h3>
                            <aura:set attribute="else">
                                <h3 class="Headingcontent">Sales Agreements</h3>
                            </aura:set>
                        </aura:if>
                        
                        <br />
                        <div class="tableClass">
                            <table class="slds-table slds-table_bordered " width="100%">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sr. No.">Sr. No.</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sales Agreement Name">Name
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Status">Status
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Account Name">Account Name</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Contract Start Date">Contract Start Date</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Contract End Date">Contract End Date</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Contract End Date">Raise Complaint</div>
                                        </th>
                                        
                                    </tr>
                                </thead>
                                <tbody>
                                     
                                    <aura:iteration items="{!v.businessWrapper.salesAgreementList}" var="salesAgreement"
                                                    indexVar="index">
                                        <aura:if isTrue="{!v.salesAgreementClick}">
                                            <aura:if isTrue="{!salesAgreement.Contract_Status__c == 'ACTIVE'}">
                                                <tr class="slds-hint-parent">
                                                    
                                                    <td style="word-wrap: break-word;">
                                                        {!index + 1}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!salesAgreement.Id}" href=""
                                                           onclick="{!c.handleSalesAgreementClick}">
                                                            {!salesAgreement.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Contract_Status__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Salesforce_Customer__r.Name}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Contract_Start_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Contract_End_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                          onclick="{!c.showCaseModal}" name="{!salesAgreement.Id}" aura:id="{!salesAgreement.Id}"/>
                                                    </td>
                                                </tr>
                                            </aura:if>
                                            <aura:set attribute="else">
                                                <tr class="slds-hint-parent">
                                                    
                                                    <td style="word-wrap: break-word;">
                                                        {!index + 1}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!salesAgreement.Id}" href=""
                                                           onclick="{!c.handleSalesAgreementClick}">
                                                            {!salesAgreement.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Contract_Status__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Salesforce_Customer__r.Name}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Contract_Start_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!salesAgreement.Contract_End_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                          onclick="{!c.showCaseModal}" name="{!salesAgreement.Id}" aura:id="{!salesAgreement.Id}"/>
                                                    </td>
                                                </tr>
                                            </aura:set>
                                        </aura:if>
                                    </aura:iteration>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
             
        </aura:if>
        
        <aura:if isTrue="{!v.assignResources}">
            <div class="documentmain animated slideInDown">
                <div class="slds-grid slds-gutters ">
                    <div class="slds-col maincantentdiv" style="padding-top:0px">
                        <aura:if isTrue="{!v.assignResourcesClick}">
                            <h3 class="Headingcontent">Active Assigned Resources</h3>
                            <aura:set attribute="else">
                                <h3 class="Headingcontent">Assigned Resources</h3>
                            </aura:set>
                        </aura:if>
                        
                        <br />
                        <div class="tableClass">
                            <table class="slds-table slds-table_bordered " width="100%">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sr. No.">Sr. No.</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Assigened Resource Name">Name
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sales Agreement Name">Sales Agreement Name
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Assign Start Date">Assign Start Date</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Assign End Date">Assign End Date</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Contract End Date">Raise Complaint</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <aura:iteration items="{!v.businessWrapper.assignedResourcesList}"
                                                    var="assignedResource" indexVar="index">
                                        <aura:if isTrue="{!v.assignResourcesClick}">
                                            <aura:if isTrue="{!assignedResource.Assign_End_Date__c >= v.today}">
                                                <tr class="slds-hint-parent">
                                                    
                                                    <td style="word-wrap: break-word;">
                                                        {!index + 1}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedResource.Id}" href=""
                                                           onclick="{!c.handleAssignedResourcesClick}">
                                                            {!assignedResource.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedResource.Sales_Agreement__c}" href=""
                                                           onclick="{!c.handleSalesAgreementClick}">
                                                            {!assignedResource.Sales_Agreement__r.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedResource.Assign_Start_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedResource.Assign_End_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                          onclick="{!c.showCaseModal}" name="{!assignedResource.Id}" aura:id="{!assignedResource.Id}"/>
                                                    </td>
                                                </tr>
                                            </aura:if>
                                            <aura:set attribute="else">
                                                <tr class="slds-hint-parent">
                                                    
                                                    <td style="word-wrap: break-word;">
                                                        {!index + 1}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedResource.Id}" href=""
                                                           onclick="{!c.handleAssignedResourcesClick}">
                                                            {!assignedResource.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedResource.Sales_Agreement__c}" href=""
                                                           onclick="{!c.handleSalesAgreementClick}">
                                                            {!assignedResource.Sales_Agreement__r.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedResource.Assign_Start_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedResource.Assign_End_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                          onclick="{!c.showCaseModal}" name="{!assignedResource.Id}" aura:id="{!assignedResource.Id}"/>
                                                    </td>
                                                </tr>
                                            </aura:set>
                                        </aura:if>
                                        
                                    </aura:iteration>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </aura:if>
        <aura:if isTrue="{!v.assignVehicles}">
            <div class="documentmain animated slideInDown">
                <div class="slds-grid slds-gutters ">
                    <div class="slds-col maincantentdiv" style="padding-top:0px">
                        <aura:if isTrue="{!v.assignVehiclesClick}">
                            <h3 class="Headingcontent">Active Assigned Vehicles</h3>
                            <aura:set attribute="else">
                                <h3 class="Headingcontent">Assigned Vehicles</h3>
                            </aura:set>
                        </aura:if>
                        <br />
                        <div class="tableClass">
                            <table class="slds-table slds-table_bordered " width="100%">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sr. No.">Sr. No.</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Name">Name
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Vehicle Number">Vehicle Number
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Vehicle Description">Vehicle Description
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sales Agreement Name">Sales Agreement Name
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Assign Start Date">Assign Start Date
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Assign End Date">Assign End Date
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Contract End Date">Raise Complaint</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <aura:iteration items="{!v.businessWrapper.assignedVehicleList}" var="assignedVehicle"
                                                    indexVar="index">
                                        
                                        <aura:if isTrue="{!v.assignVehiclesClick}">
                                            <aura:if isTrue="{!assignedVehicle.Assign_End_Date__c >= v.today}">
                                                <tr class="slds-hint-parent">
                                                    
                                                    <td style="word-wrap: break-word;">
                                                        {!index + 1}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedVehicle.Id}" href=""
                                                           onclick="{!c.handleAssignedVehiclesClick}">
                                                            {!assignedVehicle.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Vehicle_Number__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Vehicle_Description__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedVehicle.Sales_Agreement__c}" href=""
                                                           onclick="{!c.handleSalesAgreementClick}">
                                                            {!assignedVehicle.Sales_Agreement__r.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Assign_Start_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Assign_End_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                          onclick="{!c.showCaseModal}" name="{!assignedVehicle.Id}" aura:id="{!assignedVehicle.Id}"/>
                                                    </td>
                                                </tr>
                                            </aura:if>
                                            <aura:set attribute="else">
                                                <tr class="slds-hint-parent">
                                                    
                                                    <td style="word-wrap: break-word;">
                                                        {!index + 1}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedVehicle.Id}" href=""
                                                           onclick="{!c.handleAssignedVehiclesClick}">
                                                            {!assignedVehicle.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Vehicle_Number__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Vehicle_Description__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!assignedVehicle.Sales_Agreement__c}" href=""
                                                           onclick="{!c.handleSalesAgreementClick}">
                                                            {!assignedVehicle.Sales_Agreement__r.Name}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Assign_Start_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!assignedVehicle.Assign_End_Date__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                          onclick="{!c.showCaseModal}" name="{!assignedVehicle.Id}" aura:id="{!assignedVehicle.Id}"/>
                                                    </td>
                                                </tr>
                                            </aura:set>
                                        </aura:if>
                                        
                                        
                                    </aura:iteration>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </aura:if>
        <aura:if isTrue="{!not(v.govtSchool)}">
            <aura:if isTrue="{!v.invoices}">
                <div class="documentmain animated slideInDown">
                    <div class="slds-grid slds-gutters ">
                        <div class="slds-col maincantentdiv" style="padding-top:0px">
                            <aura:if isTrue="{!v.invoicesClick}">
                                <h3 class="Headingcontent">Active Invoices</h3>
                                <aura:set attribute="else">
                                    <h3 class="Headingcontent">Invoices</h3>
                                </aura:set>
                            </aura:if>
                            
                            <br />
                            <div class="tableClass">
                                <table class="slds-table slds-table_bordered " width="100%">
                                    <thead>
                                        <tr class="slds-line-height_reset">
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="Sr. No.">Sr. No.</div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="Invoice Number"> Invoice Number
                                                </div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="Total Invoice Amount"> Total Invoice Amount
                                                </div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="Invoice Description"> Invoice Description
                                                </div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="Sales Agreement Name">Sales Agreement Name
                                                </div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="Contract End Date">Raise Complaint</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <aura:iteration items="{!v.businessWrapper.invoicesList}" var="invoice"
                                                        indexVar="index">
                                            
                                            <aura:if isTrue="{!v.invoicesClick}">
                                                <aura:if isTrue="{!invoice.Contract_End_Date__c >= v.today}">
                                                    <tr class="slds-hint-parent">
                                                        
                                                        <td style="word-wrap: break-word;">
                                                            {!index + 1}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            <a id="{!invoice.Id}" href="" onclick="{!c.handleinvoicesClick}">
                                                                {!invoice.Name}
                                                            </a>
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            {!invoice.Total_Inv_Amount__c}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            {!invoice.Description__c}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            <a id="{!invoice.Sales_Agreement__c}" href=""
                                                               onclick="{!c.handleinvoicesClick}">
                                                                {!invoice.Sales_Agreement__r.Name}
                                                            </a>
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                              onclick="{!c.showCaseModal}" name="{!invoice.Id}" aura:id="{!invoice.Id}"/>
                                                        </td>
                                                    </tr>
                                                </aura:if>
                                                <aura:set attribute="else">
                                                    <tr class="slds-hint-parent">
                                                        
                                                        <td style="word-wrap: break-word;">
                                                            {!index + 1}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            <a id="{!invoice.Id}" href="" onclick="{!c.handleinvoicesClick}">
                                                                {!invoice.Name}
                                                            </a>
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            {!invoice.Total_Inv_Amount__c}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            {!invoice.Description__c}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            <a id="{!invoice.Sales_Agreement__c}" href=""
                                                               onclick="{!c.handleinvoicesClick}">
                                                                {!invoice.Sales_Agreement__r.Name}
                                                            </a>
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                              onclick="{!c.showCaseModal}" name="{!invoice.Id}" aura:id="{!invoice.Id}"/>
                                                        </td>
                                                    </tr>
                                                </aura:set>
                                            </aura:if>
                                            
                                            
                                        </aura:iteration>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </aura:if>
        </aura:if>
        <aura:if isTrue="{!v.students}">
            
            <div class="documentmain animated slideInDown">
                <div class="slds-grid slds-gutters ">
                    <div class="slds-col maincantentdiv" style="padding-top:0px">
                        <aura:if isTrue="{!v.studentsClick}">
                            <h3 class="Headingcontent">Active Students</h3>
                            <aura:set attribute="else">
                                <h3 class="Headingcontent">Students</h3>
                            </aura:set>
                        </aura:if>
                        
                        <br />
                        <div class="tableClass">
                            <table class="slds-table slds-table_bordered " width="100%">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sr. No.">Sr. No.</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Invoice Number"> Student Id
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Total Invoice Amount"> Student Name
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Invoice Description"> Parent Name
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Sales Agreement Name">Emirates Id
                                            </div>
                                        </th>
                                        <th>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <aura:iteration items="{!v.studentsList}" var="std"
                                                    indexVar="index">
                                        
                                        <tr class="slds-hint-parent">
                                            
                                            <td style="word-wrap: break-word;">
                                                {!index + 1}
                                            </td>
                                            <td style="word-wrap: break-word;">
                                                <a id="{!std.Id}" href="" onclick="{!c.handleinvoicesClick}">
                                                    {!std.ETST_Student_Id__c}
                                                </a>
                                            </td>
                                            <td style="word-wrap: break-word;">
                                                {!std.Name}
                                            </td>
                                            <td style="word-wrap: break-word;">
                                                {!std.ETST_Account_Name__r.Name}
                                            </td>
                                            <td style="word-wrap: break-word;">
                                                {!std.ETST_Emirates_Id__c}
                                            </td>
                                            <td style="word-wrap: break-word;">
                                                <lightning:button class="emmergencyButton" label="Raise Complaint" title="Raise Complaint"
                                                                  onclick="{!c.showCaseModal}" name="{!std.Id}" aura:id="{!std.Id}"/>
                                            </td>
                                        </tr>
                                        
                                    </aura:iteration>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </aura:if>
        <aura:if isTrue="{!v.showRecordDetailModal}">
            <c:BusinessCommunityRecordDetailPopup showIFrame="{!v.showRecordDetailModal}"
                                                  recordDetailId="{!v.recordDetailId}"
                                                  recordTypeName="{!v.recordTypeName}"/>
        </aura:if>
    </div>
</aura:component>